--------------------------------------------------------------------------------
DROP TABLE LOG_REFUGIO CASCADE CONSTRAINTS;
DROP TABLE ADOPCION CASCADE CONSTRAINTS;
DROP TABLE RESCATE CASCADE CONSTRAINTS;
DROP TABLE ADOPTANTE CASCADE CONSTRAINTS;
DROP TABLE MASCOTA CASCADE CONSTRAINTS;
--------------------------------------------------------------------------------
-- TABLA MASCOTA
CREATE TABLE MASCOTA (
   id_mascota   NUMBER PRIMARY KEY,
   nombre       VARCHAR2(50),
   especie      VARCHAR2(30),
   edad         NUMBER,
   estado       VARCHAR2(15)
);

-- TABLA RESCATE
CREATE TABLE RESCATE (
   id_rescate   NUMBER PRIMARY KEY,
   id_mascota   NUMBER,
   fecha        DATE,
   lugar        VARCHAR2(100),
   descripcion  VARCHAR2(200),
   CONSTRAINT fk_rescate_mascota FOREIGN KEY (id_mascota)
      REFERENCES MASCOTA(id_mascota)
);

-- TABLA ADOPTANTE
CREATE TABLE ADOPTANTE (
   id_adoptador NUMBER PRIMARY KEY,
   nombre       VARCHAR2(50),
   direccion    VARCHAR2(100),
   email        VARCHAR2(100)
);
ALTER TABLE ADOPTANTE
ADD CONSTRAINT UQ_EMAIL UNIQUE (email);

-- TABLA ADOPCION
CREATE TABLE ADOPCION (
   id_adopcion  NUMBER PRIMARY KEY,
   id_mascota   NUMBER,
   id_adoptador NUMBER,
   fecha        DATE,
   CONSTRAINT fk_adopcion_mascota FOREIGN KEY (id_mascota)
      REFERENCES MASCOTA(id_mascota),
   CONSTRAINT fk_adopcion_adoptador FOREIGN KEY (id_adoptador)
      REFERENCES ADOPTANTE(id_adoptador)
);

-- TABLA DE LOGS
CREATE TABLE LOG_REFUGIO (
   id_log       NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
   fecha_log    DATE DEFAULT SYSDATE,
   accion       VARCHAR2(100),
   detalle      VARCHAR2(4000),
   usuario_ejecuta VARCHAR2(50),
   estado       VARCHAR2(20)
);

-- INSERTS DE MASCOTAS 
INSERT INTO MASCOTA VALUES (1, 'Luna', 'Perro', 3, 'ADOPTADA');
INSERT INTO MASCOTA VALUES (2, 'Milo', 'Gato', 2, 'ADOPTADA');
INSERT INTO MASCOTA VALUES (3, 'Rocky', 'Perro', 5, 'DISPONIBLE');
INSERT INTO MASCOTA VALUES (4, 'Nala', 'Gato', 1, 'ADOPTADA');
INSERT INTO MASCOTA VALUES (5, 'Coco', 'Conejo', 4, 'RESCATADA');
INSERT INTO MASCOTA VALUES (6, 'Toby', 'Perro', 6, 'ADOPTADA');
INSERT INTO MASCOTA VALUES (7, 'Simba', 'Gato', 3, 'ADOPTADA');
INSERT INTO MASCOTA VALUES (8, 'Lola', 'Conejo', 2, 'RESCATADA');
INSERT INTO MASCOTA VALUES (9, 'Max', 'Perro', 7, 'DISPONIBLE');
INSERT INTO MASCOTA VALUES (10, 'Mimi', 'Gato', 4, 'RESCATADA');

-- INSERTS DE RESCATE
INSERT INTO RESCATE VALUES (101, 5, TO_DATE('2023-09-10','YYYY-MM-DD'), 'Zona rural', 'Conejo atrapado');
INSERT INTO RESCATE VALUES (102, 8, TO_DATE('2023-12-01','YYYY-MM-DD'), 'Zona escolar', 'Conejo encontrado');
INSERT INTO RESCATE VALUES (103, 10, TO_DATE('2024-02-10','YYYY-MM-DD'), 'Colonia sur', 'Gata embarazada');

-- INSERTS DE ADOPTANTE
INSERT INTO ADOPTANTE VALUES (201, 'Maria Lopez', 'Calle 123, Ciudad Jardin', 'maria.lopez@email.com');
INSERT INTO ADOPTANTE VALUES (202, 'Carlos Perez', 'Av. Siempre Viva 742', 'carlos.perez@email.com');
INSERT INTO ADOPTANTE VALUES (203, 'Laura Gomez', 'Calle Luna 45, Solar Norte', 'laura.gomez@email.com');
INSERT INTO ADOPTANTE VALUES (204, 'Pedro Sanchez', 'Camino Real 89', 'pedro.sanchez@email.com');
INSERT INTO ADOPTANTE VALUES (205, 'Ana Torres', 'Boulevard Estrella 56', 'ana.torres@email.com');

-- INSERTS DE ADOPCION
INSERT INTO ADOPCION VALUES (301, 1, 201, TO_DATE('2023-06-01','YYYY-MM-DD'));
INSERT INTO ADOPCION VALUES (302, 2, 202, TO_DATE('2023-07-20','YYYY-MM-DD'));
INSERT INTO ADOPCION VALUES (303, 4, 203, TO_DATE('2023-09-01','YYYY-MM-DD'));
INSERT INTO ADOPCION VALUES (304, 6, 204, TO_DATE('2023-11-20','YYYY-MM-DD'));
INSERT INTO ADOPCION VALUES (305, 7, 205, TO_DATE('2023-12-10','YYYY-MM-DD'));

COMMIT;
/

